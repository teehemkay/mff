---
import { metadata, contentForPage } from '@packages/data';
import {
  kBaseURL,
  kLanguageCodes,
  xAccount,
  kAssetsDir,
} from '@packages/data/constants';

import { makeHref, faqDetails } from '../js/utils.js';

interface Props {
  lang: string;
  currentPage: string;
  currentFAQ: string | null;
}

const { lang, currentPage, currentFAQ } = Astro.props;
const { epWebsite, epLogoAltText } = metadata(lang);

const { metaTitle, metaDescription } = currentFAQ
  ? faqDetails({ lang, currentPage, currentFAQ })
  : contentForPage(currentPage, lang);

const sharingImage = `${kBaseURL}${kAssetsDir}/img/sharing/share.png`;
const sharingImageX = `${kBaseURL}${kAssetsDir}/img/sharing/share-x.png`;

const url = (lang, currentFAQ = null) =>
  `${kBaseURL}${makeHref({ lang, currentPage, currentFAQ })}`;
---

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{metaTitle}</title>
  <meta name="description" content={metaDescription} />
  {
    currentFAQ ? (
      <meta name="robots" content="noindex, nofollow" />
    ) : (
      <meta name="robots" content="index, follow" />
    )
  }

  <link rel="canonical" href={url(lang)} />

  {
    kLanguageCodes
      .filter((code) => code !== lang)
      .map((code) => <link rel="alternate" href={url(code)} />)
  }

  <meta property="og:title" content={metaTitle} />
  <meta property="og:description" content={metaDescription} />
  <meta property="og:url" content={url(lang, currentFAQ)} />
  <meta property="og:site_name" content={epWebsite} />
  <meta property="og:locale" content={lang} />
  <meta property="og:image" content={sharingImage} />
  <meta property="og:image:alt" content={epLogoAltText} />
  <meta property="og:type" content="website" />
  <meta name="twitter:title" content={metaTitle} />
  <meta name="twitter:site" content={xAccount(lang)} />
  <meta name="twitter:description" content={metaDescription} />
  <meta name="twitter:image" content={sharingImageX} />
  <meta name="twitter:image:alt" content={epLogoAltText} />
  <meta name="twitter:image:width" content="1200" />
  <meta name="twitter:image:hight" content="1200" />
  <link rel="icon" href={`${kAssetsDir}/img/favicon.ico`} />
  <link rel="icon" href={`${kAssetsDir}/img/favicon.png`} type="image/png" />
  <link
    rel="icon"
    href={`${kAssetsDir}/img/favicon-16x16.png`}
    sizes="16x16"
    type="image/png"
  />
  <link
    rel="icon"
    href={`${kAssetsDir}/img/favicon-32x32.png`}
    sizes="32x32"
    type="image/png"
  />
  <link
    rel="apple-touch-icon"
    href={`${kAssetsDir}/img/apple-touch-icon-57x57.png`}
    sizes="57x57"
    type="image/png"
  />
  <link
    rel="apple-touch-icon"
    href={`${kAssetsDir}/img/apple-touch-icon-72x72.png`}
    sizes="72x72"
    type="image/png"
  />
  <link
    rel="apple-touch-icon"
    href={`${kAssetsDir}/img/apple-touch-icon-144x144.png`}
    sizes="144x144"
    type="image/png"
  />

  <noscript>
    <link href=`${kAssetsDir}/css/index-nojs.css` rel="stylesheet" />
  </noscript>

  <link href=`${kAssetsDir}/css/tailwind.css` rel="stylesheet" />
  <link href=`${kAssetsDir}/css/index.css` rel="stylesheet" />

  <script
    is:inline
    defer
    data-tracker-name="ATInternet"
    data-value="https://www.europarl.europa.eu/website/webanalytics/ati-eu-budget.js"
    src=`${kAssetsDir}/privacy-policy/privacy-policy.js`></script>
</head>

<script is:inline type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://www.elections.europa.eu",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://eubudget.europarl.europa.eu/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    },
    "publisher": {
      "@type": "Organization",
      "name": "European Parliament",
      "logo": {
        "@type": "ImageObject",
        "url": "/assets/img/ep-logo.png"
      }
    }
  }
</script>
